
R version 3.3.1 Patched (2016-10-17 r71532) -- "Bug in Your Hair"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Tests for zero-inputs into various diffHic functions.
> 
> suppressWarnings(suppressPackageStartupMessages(require(diffHic)))
> 
> # Don't worry about cases involving empty files; 
> # that just shouldn't be a practical concern.
> 
> ghost <- InteractionSet(matrix(0, nrow=0, ncol=1), 
+     GInteractions(integer(0), integer(0), regions=GRanges("chrA", IRanges(1:5, 1:5)), mode="reverse"),
+     colData=DataFrame(totals=1e6))
> 
> getArea(ghost)
numeric(0)
> getArea(ghost, bp=TRUE)
numeric(0)
> 
> f.out <- "empty.h5"
> param <- pairParam(GRanges("chrA", IRanges(1:5, 1:5)))
> savePairs(data.frame(anchor1.id=integer(0), anchor2.id=integer(0)), file=f.out, param=param)
> 
> loadChromos(f.out) # While we're here, let's see what happens.
[1] anchor1 anchor2
<0 rows> (or 0-length row.names)
> unlink(f.out)
> 
> filterDirect(ghost)
$abundances
numeric(0)

$threshold
[1] 0.9999942

Warning message:
In .getInterThreshold(all.chrs, ave.ab[is.inter], empty = .makeEmpty(data,  :
  insufficient inter-chromosomal pairs for reliable threshold estimation
> filterDirect(ghost, reference=ghost)
$abundances
numeric(0)

$threshold
[1] 0.9999942

$ref
$ref$abundances
numeric(0)

$ref$threshold
[1] 0.9999942


Warning message:
In .getInterThreshold(all.chrs, ave.ab[is.inter], empty = .makeEmpty(data,  :
  insufficient inter-chromosomal pairs for reliable threshold estimation
> 
> filterTrended(ghost)
$abundances
numeric(0)

$threshold
logical(0)

$log.distance
numeric(0)

Warning message:
In filterTrended(ghost) :
  too many missing regions in the intra-chromosomal interaction space to fill in
> try(filterTrended(ghost, reference=ghost)) # This will fail, as interpolation is impossible.
Error in approx(x = ref$log.distance, y = ref$threshold, xout = actual.dist,  : 
  need at least two non-NA values to interpolate
In addition: Warning message:
In filterTrended(ghost, reference = ghost) :
  too many missing regions in the intra-chromosomal interaction space to fill in
> 
> filterPeaks(ghost, integer(0))
logical(0)
> 
> enrichedPairs(ghost, abundances=numeric(0))
numeric(0)
> 
> try(compartmentalize(ghost)) # This will fail, as interpolation is impossible.
Error in approxfun(x = trended$log.distance, y = trended$threshold, rule = 2) : 
  need at least two non-NA values to interpolate
In addition: Warning message:
In filterTrended(data) :
  too many missing regions in the intra-chromosomal interaction space to fill in
> try(compartmentalize(ghost, dist.correct=FALSE)) # This will also fail, due to non-unique k-means.
Error in kmeans(mat, centers = centers, ...) : 
  more cluster centers than distinct data points.
> 
> correctedContact(ghost)
$truth
numeric(0)

$bias
[1] NA NA NA NA NA

$max
 [1] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
[39] 0 0 0 0 0 0 0 0 0 0 0 0

> 
> ghost.ranges <- SummarizedExperiment(matrix(0, 0, 1), GRanges())
> try(normalizeCNV(ghost, ghost.ranges)) # locfit isn't as robust as loessFit
Error in locfit(i.fc ~ cov.fun, maxk = maxk, ..., lfproc = locfit.robust) : 
  fewer than one row in the data
In addition: Warning message:
In normalizeCNV(ghost, ghost.ranges) :
  library sizes should be identical for margin and data objects
> 
> matchMargins(ghost, ghost.ranges)
[1] anchor1 anchor2
<0 rows> (or 0-length row.names)
> 
> asDGEList(ghost)
An object of class "DGEList"
$counts
     Sample1

$samples
        group lib.size norm.factors
Sample1     1    1e+06            1

> 
> normOffsets(ghost)
[1] 1
> normOffsets(ghost, type="loess")
     [,1]
> 
> diClusters(ghost, data.frame(PValue=integer(0), logFC=numeric(0)), target=0.05, cluster.args=list(tol=1))
$indices
$indices[[1]]
integer(0)


$interactions
ReverseStrictGInteractions object with 0 interactions and 0 metadata columns:
   seqnames1   ranges1     seqnames2   ranges2
       <Rle> <IRanges>         <Rle> <IRanges>
  -------
  regions: 0 ranges and 0 metadata columns
  seqinfo: 1 sequence from an unspecified genome; no seqlengths

$FDR
[1] 0

> 
> annotatePairs(ghost, indices=integer(0), regions=GRanges())
$anchor1
character(0)

$anchor2
character(0)

> 
> 
> proc.time()
   user  system elapsed 
  7.588   0.140   7.740 
