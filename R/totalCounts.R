totalCounts <- function(files, param)
# This function gets the total counts in a bunch of files.  This is designed
# for whenever the total counts must be rapidly extracted, without the need to
# count across the interaction space.
#
# written by Aaron Lun
# created 17 September 2014
# last modified 17 March 2017
{
	nlibs <- length(files)
	if (nlibs==0L) { stop("number of libraries must be positive") }
	full.sizes <- integer(nlibs)

	# Setting up other local references.
    parsed <- .parseParam(param)
    chrs <- parsed$chrs
    frag.by.chr <- parsed$frag.by.chr
    cap <- parsed$cap
    discard <- parsed$discard
    restrict <- param$restrict

	# Running through each pair of chromosomes.
	overall <- .loadIndices(files, chrs, restrict)
    for (anchor in names(overall)) {
        current <- overall[[anchor]]
		for (target in names(current)) {

			# Getting totals.
			pairs <- .baseHiCParser(current[[target]], files, anchor, target, 
				chr.limits=frag.by.chr, discard=discard, cap=cap, bwidth=NA_integer_)
			full.sizes <- full.sizes + sapply(pairs, FUN=nrow)
		}
	}

	return(full.sizes)
}


